<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>6.0</version>
    <date>2022-06-14T18:44:19Z</date>
    <groups>
        <group>
            <uuid>38de2e12cb8849909b38f1a0eda28bbd</uuid>
            <name>Devices/Firewalls</name>
        </group>
    </groups>
    <templates>
        <template>
            <uuid>3cf344c8659446ccb2b5a63e8d96d65e</uuid>
            <template>Template - Fortinet Fortigate</template>
            <name>Template - Fortinet Fortigate</name>
            <description>Template para Firewalls Fortigate via SNMP

Modelo de Validacao: Fortinet Fortigate 80E

Por: Vinicius Goncalves</description>
            <templates>
                <template>
                    <name>Template - Dispositivo Generico SNMP</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Devices/Firewalls</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>3695b52d2f3c4400ae667eb6d07b5d65</uuid>
                    <name>HA - Nome do Cluster</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.4.1.12356.101.13.1.7.0</snmp_oid>
                    <key>fgHaGroupName</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                </item>
                <item>
                    <uuid>e2e47afe2b0b4f28a90d496297bc4720</uuid>
                    <name>HA - Modo de configuração</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.4.1.12356.101.13.1.1.0</snmp_oid>
                    <key>fgHaSystemMode</key>
                    <delay>1h</delay>
                    <description>Standalone, Active-actice ou active-passive</description>
                    <valuemap>
                        <name>FORTINET::HaMode</name>
                    </valuemap>
                </item>
                <item>
                    <uuid>5dd6330d46834d06b822e4b229afcff4</uuid>
                    <name>IPS - Detecção Severidade Crítica</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.4.1.12356.101.9.2.1.1.3.1</snmp_oid>
                    <key>fgIpsCritSevDetections</key>
                </item>
                <item>
                    <uuid>0d0abb82c47c49b59794bb736fa7b6d2</uuid>
                    <name>IPS - Detecção Severidade Alta</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.4.1.12356.101.9.2.1.1.4.1</snmp_oid>
                    <key>fgIpsHighSevDetections</key>
                </item>
                <item>
                    <uuid>a75bb48c534d4cdf9b764bd88facd52a</uuid>
                    <name>IPS - Total Bloqueado</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.4.1.12356.101.9.2.1.1.2.1</snmp_oid>
                    <key>fgIpsIntrusionsBlocked</key>
                </item>
                <item>
                    <uuid>0c7e92d831294c069c0b8543ec15dec3</uuid>
                    <name>IPS - Total Detectado</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.4.1.12356.101.9.2.1.1.1.1</snmp_oid>
                    <key>fgIpsIntrusionsDetected</key>
                </item>
                <item>
                    <uuid>c9a5abee323b4b8bb69d765d22fda926</uuid>
                    <name>IPS - Detecção Severidade Baixa</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.4.1.12356.101.9.2.1.1.6.1</snmp_oid>
                    <key>fgIpsLowSevDetections</key>
                </item>
                <item>
                    <uuid>ada20cd2cc9549cb956ae30e821c73dd</uuid>
                    <name>IPS - Detecção Severidade Média</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.4.1.12356.101.9.2.1.1.5.1</snmp_oid>
                    <key>fgIpsMedSevDetections</key>
                </item>
                <item>
                    <uuid>68e712eecf534980a26122951d7ff17f</uuid>
                    <name>Status - Utilização da CPU (%)</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.4.1.12356.101.4.1.3.0</snmp_oid>
                    <key>fgSysCpuUsage</key>
                    <units>%</units>
                    <triggers>
                        <trigger>
                            <uuid>1e61b481a71f47f0a9f0b9c893e13cd3</uuid>
                            <expression>min(/Template - Fortinet Fortigate/fgSysCpuUsage,5m)&gt;{$CPU.UTIL.CRIT}</expression>
                            <name>Alta Utilização da CPU (&gt;{$CPU.UTIL.CRIT}%)</name>
                            <opdata>Current utilization: {ITEM.LASTVALUE1}</opdata>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>a26c258edfd3472a8613fe1e66fc084d</uuid>
                    <name>Status - Utilização da Memória (%)</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.4.1.12356.101.4.1.4.0</snmp_oid>
                    <key>fgSysMemUsage</key>
                    <units>%</units>
                    <triggers>
                        <trigger>
                            <uuid>e2208c75db094a5498e0d5b289286d8e</uuid>
                            <expression>min(/Template - Fortinet Fortigate/fgSysMemUsage,5m)&gt;{$MEMORY.UTIL.MAX}</expression>
                            <name>Alta Utilização de Memória ( &gt;{$MEMORY.UTIL.MAX}%)</name>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>881b99125d8c424e915f8429cd5187f5</uuid>
                    <name>Status - Sessões Ativas</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.4.1.12356.101.4.1.8.0</snmp_oid>
                    <key>fgSysSesCount</key>
                </item>
                <item>
                    <uuid>bad4294b4ca64b539fb0f66108afc319</uuid>
                    <name>System - Versão do Firmware</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.4.1.12356.101.4.1.1.0</snmp_oid>
                    <key>fgSysVersion</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <inventory_link>OS_SHORT</inventory_link>
                </item>
                <item>
                    <uuid>afa9117b8a384d1db03ac670ae999904</uuid>
                    <name>VPN - Status SSLVPN</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.4.1.12356.101.12.2.3.1.1.1</snmp_oid>
                    <key>fgVpnSslState</key>
                    <valuemap>
                        <name>FORTINET::BoolState</name>
                    </valuemap>
                </item>
                <item>
                    <uuid>ce9d610697bf45278283396b04b298fb</uuid>
                    <name>VPN - Usuários SSLVPN Ativos</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.4.1.12356.101.12.2.3.1.2.1</snmp_oid>
                    <key>fgVpnSslStatsLoginUsers</key>
                </item>
                <item>
                    <uuid>017a7c90d83548309f4ce2a8a7fbcfea</uuid>
                    <name>VPN - Túneis IPsec Ativos</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.4.1.12356.101.12.1.1.0</snmp_oid>
                    <key>fgVpnTunnelUpCount</key>
                </item>
                <item>
                    <uuid>0eec5060630f44af971b2e45cf384c31</uuid>
                    <name>System - Serial Number do Equipamento</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.4.1.12356.100.1.1.1.0</snmp_oid>
                    <key>fnSysSerial</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <inventory_link>SERIALNO_A</inventory_link>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <uuid>48870f7bbd2f443fb3159a370350a752</uuid>
                    <name>Descoberta de HA</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#HA_ID},1.3.6.1.4.1.12356.101.13.2.1.1.1,{#HA_SN},1.3.6.1.4.1.12356.101.13.2.1.1.2]</snmp_oid>
                    <key>fgHaStatsTable.discovery</key>
                    <delay>1h</delay>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>4858758b7c184426905df1cca2f4fa5b</uuid>
                            <name>HA - FRW-MORAR-0{#HA_ID}: Serial Number do Equipamento</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.12356.101.13.2.1.1.2.{#HA_ID}</snmp_oid>
                            <key>fgHaStatsSerial.[{#HA_ID}]</key>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                        </item_prototype>
                        <item_prototype>
                            <uuid>1e54ee9484af44dba3e4ce4e66ff5ec3</uuid>
                            <name>HA - FRW-MORAR-0{#HA_ID}: Status de Sincronização</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.12356.101.13.2.1.1.12.{#HA_ID}</snmp_oid>
                            <key>fgHaStatsSyncStatus.[{#HA_ID}]</key>
                            <valuemap>
                                <name>FORTINET::HaSyncStatus</name>
                            </valuemap>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <uuid>59c000a0ac234b26a86b7a6654e8fa42</uuid>
                    <name>Descoberta de SD-WAN Health Check</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#HC_ID},1.3.6.1.4.1.12356.101.4.9.2.1.1,{#HC_NAME},1.3.6.1.4.1.12356.101.4.9.2.1.2,{#MEMBER_SEQ},1.3.6.1.4.1.12356.101.4.9.2.1.3,{#VDOM},1.3.6.1.4.1.12356.101.4.9.2.1.10]</snmp_oid>
                    <key>fgVWLHealthCheckLink.discovery</key>
                    <delay>1h</delay>
                    <lifetime>0</lifetime>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>cd82a815f5a3493589897ab6698ea445</uuid>
                            <name>SD-WAN - {#HC_NAME}: Jitter</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.12356.101.4.9.2.1.6.{#HC_ID}</snmp_oid>
                            <key>fgVWLHealthCheckLinkJitter[{#HC_NAME}.{#MEMBER_SEQ}]</key>
                            <delay>30s</delay>
                            <value_type>FLOAT</value_type>
                            <units>ms</units>
                        </item_prototype>
                        <item_prototype>
                            <uuid>319d48aaa2b945d1ab07deba80eca855</uuid>
                            <name>SD-WAN - {#HC_NAME}: Latência</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.12356.101.4.9.2.1.5.{#HC_ID}</snmp_oid>
                            <key>fgVWLHealthCheckLinkLatency[{#HC_NAME}.{#MEMBER_SEQ}]</key>
                            <delay>30s</delay>
                            <value_type>FLOAT</value_type>
                            <units>ms</units>
                        </item_prototype>
                        <item_prototype>
                            <uuid>e8d35cfffce7421baf2e75430b194d04</uuid>
                            <name>SD-WAN - {#HC_NAME}: Perda de Pacotes (%)</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.12356.101.4.9.2.1.9.{#HC_ID}</snmp_oid>
                            <key>fgVWLHealthCheckLinkPacketLoss[{#HC_NAME}.{#MEMBER_SEQ}]</key>
                            <delay>30s</delay>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                        </item_prototype>
                        <item_prototype>
                            <uuid>c38ee0115946440c997d0f2151c38c58</uuid>
                            <name>SD-WAN - {#HC_NAME}: Health Check State</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.12356.101.4.9.2.1.4.{#HC_ID}</snmp_oid>
                            <key>fgVWLHealthCheckLinkState[{#HC_ID}]</key>
                            <delay>30s</delay>
                            <valuemap>
                                <name>FORTINET::AlarmState</name>
                            </valuemap>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>7dd0117ca4b345429e808662da674630</uuid>
                                    <expression>last(/Template - Fortinet Fortigate/fgVWLHealthCheckLinkState[{#HC_ID}])=1 and (last(/Template - Fortinet Fortigate/fgVWLHealthCheckLinkState[{#HC_ID}],#1)&lt;&gt;last(/Template - Fortinet Fortigate/fgVWLHealthCheckLinkState[{#HC_ID}],#2))=1</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>last(/Template - Fortinet Fortigate/fgVWLHealthCheckLinkState[{#HC_ID}])=0</recovery_expression>
                                    <name>SD-WAN - {#HC_NAME}: Falha no Health Check State.</name>
                                    <opdata>Status: {ITEM.LASTVALUE1}</opdata>
                                    <priority>HIGH</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <uuid>e34510ea2a35479ba06b7d9eceb96114</uuid>
                            <name>SD-WAN - {#HC_NAME}: Métricas da Performance SLA</name>
                            <ymin_type_1>FIXED</ymin_type_1>
                            <graph_items>
                                <graph_item>
                                    <color>F63100</color>
                                    <item>
                                        <host>Template - Fortinet Fortigate</host>
                                        <key>fgVWLHealthCheckLinkJitter[{#HC_NAME}.{#MEMBER_SEQ}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>2774A4</color>
                                    <item>
                                        <host>Template - Fortinet Fortigate</host>
                                        <key>fgVWLHealthCheckLinkLatency[{#HC_NAME}.{#MEMBER_SEQ}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>F7941D</color>
                                    <item>
                                        <host>Template - Fortinet Fortigate</host>
                                        <key>fgVWLHealthCheckLinkPacketLoss[{#HC_NAME}.{#MEMBER_SEQ}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <uuid>2d0fb844e8b14991ba3bb8b76c4d32be</uuid>
                    <name>Descoberta de Interface de Rede</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFADMINSTATUS},1.3.6.1.2.1.2.2.1.7,{#IFALIAS},1.3.6.1.2.1.31.1.1.1.18,{#IFNAME},1.3.6.1.2.1.31.1.1.1.1,{#IFDESCR},1.3.6.1.2.1.2.2.1.2,{#IFTYPE},1.3.6.1.2.1.2.2.1.3]</snmp_oid>
                    <key>net.if.discovery</key>
                    <delay>1h</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#IFADMINSTATUS}</macro>
                                <value>{$NET.IF.IFADMINSTATUS.MATCHES}</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFADMINSTATUS}</macro>
                                <value>{$NET.IF.IFADMINSTATUS.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>B</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFOPERSTATUS}</macro>
                                <value>{$NET.IF.IFOPERSTATUS.MATCHES}</value>
                                <formulaid>I</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFOPERSTATUS}</macro>
                                <value>{$NET.IF.IFOPERSTATUS.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>J</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFNAME}</macro>
                                <value>{$NET.IF.IFNAME.MATCHES}</value>
                                <formulaid>G</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFNAME}</macro>
                                <value>{$NET.IF.IFNAME.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>H</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFDESCR}</macro>
                                <value>{$NET.IF.IFDESCR.MATCHES}</value>
                                <formulaid>E</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFDESCR}</macro>
                                <value>{$NET.IF.IFDESCR.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>F</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFALIAS}</macro>
                                <value>{$NET.IF.IFALIAS.MATCHES}</value>
                                <formulaid>C</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFALIAS}</macro>
                                <value>{$NET.IF.IFALIAS.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>D</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFTYPE}</macro>
                                <value>{$NET.IF.IFTYPE.MATCHES}</value>
                                <formulaid>K</formulaid>
                            </condition>
                            <condition>
                                <macro>{#IFTYPE}</macro>
                                <value>{$NET.IF.IFTYPE.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>L</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>d2c89a0d39f041eea0f6b41e9aff028b</uuid>
                            <name>Network - Interface {#IFNAME}({#IFALIAS}): Tráfego de Entrada</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.31.1.1.1.6.{#SNMPINDEX}</snmp_oid>
                            <key>net.if.in[ifHCInOctets.{#SNMPINDEX}]</key>
                            <delay>3m</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>8</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <uuid>197c65dd0bd1489d90cf5c25e82c21dd</uuid>
                            <name>Network - Interface {#IFNAME}({#IFALIAS}): Tráfego de Saída</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.31.1.1.1.10.{#SNMPINDEX}</snmp_oid>
                            <key>net.if.out[ifHCOutOctets.{#SNMPINDEX}]</key>
                            <delay>3m</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>8</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <uuid>4c27c2c657664c6a81552171f4d30b0d</uuid>
                            <name>Network - Interface {#IFNAME}({#IFALIAS}): Speed</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.31.1.1.1.15.{#SNMPINDEX}</snmp_oid>
                            <key>net.if.speed[ifHighSpeed.{#SNMPINDEX}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <units>bps</units>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>1000000</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <uuid>761dbd4cf23345daaee0368f93093301</uuid>
                            <name>Network - Interface {#IFNAME}({#IFALIAS}): Status Operacional</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.2.2.1.8.{#SNMPINDEX}</snmp_oid>
                            <key>net.if.status[ifOperStatus.{#SNMPINDEX}]</key>
                            <history>7d</history>
                            <trends>0</trends>
                            <valuemap>
                                <name>SNMP::OperStatus</name>
                            </valuemap>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>9434b336ec9e429d90f352a38da621cc</uuid>
                                    <expression>{$IFCONTROL}=1 and 
(last(/Template - Fortinet Fortigate/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and 
(last(/Template - Fortinet Fortigate/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)&lt;&gt;last(/Template - Fortinet Fortigate/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))=1)</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>last(/Template - Fortinet Fortigate/net.if.status[ifOperStatus.{#SNMPINDEX}])&lt;&gt;2 or 
{$IFCONTROL}=0</recovery_expression>
                                    <name>Interface {#IFNAME}({#IFALIAS}): Link Down</name>
                                    <opdata>Current state: {ITEM.LASTVALUE1}</opdata>
                                    <priority>AVERAGE</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <uuid>46d797a4bc4142d8b1e067f46734caa9</uuid>
                            <expression>(avg(/Template - Fortinet Fortigate/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)&gt;({$IF.UTIL.MAX}/100)*last(/Template - Fortinet Fortigate/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) or
avg(/Template - Fortinet Fortigate/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)&gt;({$IF.UTIL.MAX}/100)*last(/Template - Fortinet Fortigate/net.if.speed[ifHighSpeed.{#SNMPINDEX}])) and
last(/Template - Fortinet Fortigate/net.if.speed[ifHighSpeed.{#SNMPINDEX}])&gt;0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>avg(/Template - Fortinet Fortigate/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)&lt;(({$IF.UTIL.MAX}-3)/100)*last(/Template - Fortinet Fortigate/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) and
avg(/Template - Fortinet Fortigate/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)&lt;(({$IF.UTIL.MAX}-3)/100)*last(/Template - Fortinet Fortigate/net.if.speed[ifHighSpeed.{#SNMPINDEX}])</recovery_expression>
                            <name>Interface {#IFNAME}({#IFALIAS}): Alta Utilização de Banda (&gt;{$IF.UTIL.MAX}% )</name>
                            <opdata>In: {ITEM.LASTVALUE1}, out: {ITEM.LASTVALUE3}, speed: {ITEM.LASTVALUE2}</opdata>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Interface {#IFNAME}({#IFALIAS}): Link Down</name>
                                    <expression>{$IFCONTROL}=1 and 
(last(/Template - Fortinet Fortigate/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and 
(last(/Template - Fortinet Fortigate/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)&lt;&gt;last(/Template - Fortinet Fortigate/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))=1)</expression>
                                    <recovery_expression>last(/Template - Fortinet Fortigate/net.if.status[ifOperStatus.{#SNMPINDEX}])&lt;&gt;2 or 
{$IFCONTROL}=0</recovery_expression>
                                </dependency>
                            </dependencies>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <uuid>854e0424fd9045e8936704ed224244a8</uuid>
                            <name>Network - Interface {#IFNAME}({#IFALIAS}): Tráfego de Rede</name>
                            <graph_items>
                                <graph_item>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>Template - Fortinet Fortigate</host>
                                        <key>net.if.in[ifHCInOctets.{#SNMPINDEX}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>2774A4</color>
                                    <item>
                                        <host>Template - Fortinet Fortigate</host>
                                        <key>net.if.out[ifHCOutOctets.{#SNMPINDEX}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
            </discovery_rules>
            <tags>
                <tag>
                    <tag>Tag</tag>
                    <value>Fortigate</value>
                </tag>
            </tags>
            <macros>
                <macro>
                    <macro>{$CPU.UTIL.CRIT}</macro>
                    <value>80</value>
                </macro>
                <macro>
                    <macro>{$ICMP_LOSS_WARN}</macro>
                    <value>20</value>
                </macro>
                <macro>
                    <macro>{$ICMP_RESPONSE_TIME_WARN}</macro>
                    <value>0.15</value>
                </macro>
                <macro>
                    <macro>{$IF.UTIL.MAX}</macro>
                    <value>90</value>
                </macro>
                <macro>
                    <macro>{$IFCONTROL}</macro>
                    <value>1</value>
                </macro>
                <macro>
                    <macro>{$MEMORY.UTIL.MAX}</macro>
                    <value>80</value>
                </macro>
                <macro>
                    <macro>{$SNMP.TIMEOUT}</macro>
                    <value>5m</value>
                </macro>
            </macros>
            <dashboards>
                <dashboard>
                    <uuid>1f82d6d4dcc648b2ad2f0c316142fec0</uuid>
                    <name>SD-WAN - Performance SLA</name>
                    <pages>
                        <page>
                            <widgets>
                                <widget>
                                    <type>GRAPH_PROTOTYPE</type>
                                    <width>24</width>
                                    <height>5</height>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>columns</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>GRAPH_PROTOTYPE</type>
                                            <name>graphid</name>
                                            <value>
                                                <name>SD-WAN - {#HC_NAME}: Métricas da Performance SLA</name>
                                                <host>Template - Fortinet Fortigate</host>
                                            </value>
                                        </field>
                                    </fields>
                                </widget>
                            </widgets>
                        </page>
                    </pages>
                </dashboard>
                <dashboard>
                    <uuid>2b2f5af3127b42afaf27b97bf63a2542</uuid>
                    <name>System - Performance do Sistema</name>
                    <pages>
                        <page>
                            <widgets>
                                <widget>
                                    <type>GRAPH_CLASSIC</type>
                                    <width>12</width>
                                    <height>5</height>
                                    <fields>
                                        <field>
                                            <type>GRAPH</type>
                                            <name>graphid</name>
                                            <value>
                                                <name>Status - Utilização de CPU e Memória</name>
                                                <host>Template - Fortinet Fortigate</host>
                                            </value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>GRAPH_CLASSIC</type>
                                    <x>12</x>
                                    <width>12</width>
                                    <height>5</height>
                                    <fields>
                                        <field>
                                            <type>GRAPH</type>
                                            <name>graphid</name>
                                            <value>
                                                <name>Status - Sessões Simultâneas</name>
                                                <host>Template - Fortinet Fortigate</host>
                                            </value>
                                        </field>
                                    </fields>
                                </widget>
                            </widgets>
                        </page>
                    </pages>
                </dashboard>
            </dashboards>
            <valuemaps>
                <valuemap>
                    <uuid>2ae6c2a701a34778a7c68c70240026d4</uuid>
                    <name>FORTINET::AlarmState</name>
                    <mappings>
                        <mapping>
                            <value>0</value>
                            <newvalue>Ok</newvalue>
                        </mapping>
                        <mapping>
                            <value>1</value>
                            <newvalue>Alarm</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
                <valuemap>
                    <uuid>c42711c41d3849ffb4ebab1e5d159fc0</uuid>
                    <name>FORTINET::BoolState</name>
                    <mappings>
                        <mapping>
                            <value>1</value>
                            <newvalue>Disabled</newvalue>
                        </mapping>
                        <mapping>
                            <value>2</value>
                            <newvalue>Enabled</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
                <valuemap>
                    <uuid>3ad5d8110eb449fda3339946e64b15e6</uuid>
                    <name>FORTINET::HaMode</name>
                    <mappings>
                        <mapping>
                            <value>1</value>
                            <newvalue>StandAlone</newvalue>
                        </mapping>
                        <mapping>
                            <value>2</value>
                            <newvalue>ActiveActive</newvalue>
                        </mapping>
                        <mapping>
                            <value>3</value>
                            <newvalue>ActivePassive</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
                <valuemap>
                    <uuid>a47f2784fccf4be4be2c7afa3d0a0849</uuid>
                    <name>FORTINET::HaSyncStatus</name>
                    <mappings>
                        <mapping>
                            <value>0</value>
                            <newvalue>Unsynchronized</newvalue>
                        </mapping>
                        <mapping>
                            <value>1</value>
                            <newvalue>Synchronized</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
                <valuemap>
                    <uuid>364e47923e114ed8b75220f816f4d915</uuid>
                    <name>SNMP::HostAvailable</name>
                    <mappings>
                        <mapping>
                            <value>0</value>
                            <newvalue>NotAvailable</newvalue>
                        </mapping>
                        <mapping>
                            <value>1</value>
                            <newvalue>Available</newvalue>
                        </mapping>
                        <mapping>
                            <value>2</value>
                            <newvalue>Unknown</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
                <valuemap>
                    <uuid>79cf9b4d9ffc4ab6917039c7f7382cee</uuid>
                    <name>SNMP::OperStatus</name>
                    <mappings>
                        <mapping>
                            <value>1</value>
                            <newvalue>Up</newvalue>
                        </mapping>
                        <mapping>
                            <value>2</value>
                            <newvalue>Down</newvalue>
                        </mapping>
                        <mapping>
                            <value>4</value>
                            <newvalue>Unknown</newvalue>
                        </mapping>
                        <mapping>
                            <value>5</value>
                            <newvalue>Dormant</newvalue>
                        </mapping>
                        <mapping>
                            <value>6</value>
                            <newvalue>NotPresent</newvalue>
                        </mapping>
                        <mapping>
                            <value>7</value>
                            <newvalue>LowerLayerDown</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
                <valuemap>
                    <uuid>0670c0e778054503bf121c119b1d424b</uuid>
                    <name>SNMP::ServiceState</name>
                    <mappings>
                        <mapping>
                            <value>0</value>
                            <newvalue>Down</newvalue>
                        </mapping>
                        <mapping>
                            <value>1</value>
                            <newvalue>Up</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
            </valuemaps>
        </template>
    </templates>
    <graphs>
        <graph>
            <uuid>03f4e2f88f70496abc3bc6a1585018fb</uuid>
            <name>IPS - Métricas de Detecção</name>
            <type>STACKED</type>
            <ymin_type_1>FIXED</ymin_type_1>
            <graph_items>
                <graph_item>
                    <color>C7A72D</color>
                    <item>
                        <host>Template - Fortinet Fortigate</host>
                        <key>fgIpsLowSevDetections</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>BA2A5D</color>
                    <item>
                        <host>Template - Fortinet Fortigate</host>
                        <key>fgIpsMedSevDetections</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>FC6EA3</color>
                    <item>
                        <host>Template - Fortinet Fortigate</host>
                        <key>fgIpsHighSevDetections</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>3</sortorder>
                    <color>F7941D</color>
                    <item>
                        <host>Template - Fortinet Fortigate</host>
                        <key>fgIpsCritSevDetections</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>4</sortorder>
                    <color>199C0D</color>
                    <item>
                        <host>Template - Fortinet Fortigate</host>
                        <key>fgIpsIntrusionsBlocked</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>5</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>Template - Fortinet Fortigate</host>
                        <key>fgIpsIntrusionsDetected</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>74468f2485d24f7faa0372eee8506164</uuid>
            <name>Status - Sessões Simultâneas</name>
            <ymin_type_1>FIXED</ymin_type_1>
            <graph_items>
                <graph_item>
                    <color>199C0D</color>
                    <item>
                        <host>Template - Fortinet Fortigate</host>
                        <key>fgSysSesCount</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>a208e851483645fb9927700e8254bffe</uuid>
            <name>Status - Utilização de CPU e Memória</name>
            <ymin_type_1>FIXED</ymin_type_1>
            <ymax_type_1>FIXED</ymax_type_1>
            <graph_items>
                <graph_item>
                    <color>1A7C11</color>
                    <item>
                        <host>Template - Fortinet Fortigate</host>
                        <key>fgSysCpuUsage</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>2774A4</color>
                    <item>
                        <host>Template - Fortinet Fortigate</host>
                        <key>fgSysMemUsage</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>af4dec6fa2134adf89bdff7e2b793578</uuid>
            <name>VPN - Túneis VPN Ativos (IPsec+SSL)</name>
            <graph_items>
                <graph_item>
                    <color>199C0D</color>
                    <item>
                        <host>Template - Fortinet Fortigate</host>
                        <key>fgVpnTunnelUpCount</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>0080FF</color>
                    <item>
                        <host>Template - Fortinet Fortigate</host>
                        <key>fgVpnSslStatsLoginUsers</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
    </graphs>
</zabbix_export>
